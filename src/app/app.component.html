<!-- The main page of the application, currSection = 0: -->
@if(currSection == 0) {
<div class="container">
  <img
    class="logo"
    src="../assets/logo.png"
    alt="{{ settings.getString('IMG_LOGO_ALT') }}"
  />
  <button (click)="goToSelectBoardSize()" class="btn">
    {{ settings.getString("BT_PLAY") }}
  </button>
  <button (click)="goToStatistics()" class="btn">
    {{ settings.getString("BT_STATISTICS") }}
  </button>
  <button (click)="goToSettings()" class="btn">
    {{ settings.getString("BT_SETTINGS") }}
  </button>
  <button (click)="goToAbout()" class="btn">
    {{ settings.getString("BT_ABOUT") }}
  </button>
</div>
}
<!-- end main page of the application. -->

<!-- The level choosing zone: -->
@if(currSection == 1) {
<div class="container">
  <button
    (click)="goBackToMain()"
    class="back-btn"
    [attr.aria-label]="settings.getString('BT_BACK')"
  >
    <img src="../assets/arrow-left-solid.svg" alt="" />
  </button>

  <button (click)="goToGame(3)" class="btn">3X3</button>
  <button (click)="goToGame(4)" class="btn">4X4</button>
  <button (click)="goToGame(5)" class="btn">5X5</button>
</div>
}
<!-- end level page of the application. -->

<!-- The game zone, third page of the application, currSection = 2: -->
@if(currSection == 2) {
<div class="container" id="confetti">
  <button
    (click)="goBackToMain()"
    class="back-btn"
    [disabled]="gameStarted"
    [attr.aria-label]="settings.getString('BT_BACK')"
  >
    <img src="../assets/arrow-left-solid.svg" alt="" />
  </button>
  <!-- Timer and moves div: -->
  <div class="timer-moves">
    <div class="timer">
      <p>
        {{ padNumber(timerValueSec / 60) }}:{{ padNumber(timerValueSec % 60) }}
      </p>
    </div>
    <div class="timer moves">
      <p>
        {{ nrMoves }}
      </p>
    </div>
  </div>
  <!-- end timer div. -->
  @if(gameWon) {
  <p class="gameWon" role="alert">
    {{ settings.getString("MSG_CONGRATS") }}
    <br />
    {{ settings.formatString("MSG_YOU_WON", "" + finalScore) }}
  </p>
  }
  <!-- div for making the board look 3d -->
  <div class="board-sides">
    <!-- board div  -->
    <div
      class="board"
      [ngClass]="{
        grid3: boardSize == 3,
        grid4: boardSize == 4,
        grid5: boardSize == 5
      }"
      (touchstart)="onTouchStart($event)"
      (touchmove)="onTouchMove($event)"
      (touchend)="onTouchEnd($event)"
    >
      <!-- A for for pieces: -->
      @for(piece of pieces; track $index; let i = $index) {
      <div
        class="piece"
        [ngClass]="{
          'invisible-piece': piece.number == 0
        }"
        (click)="move(piece)"
        [style.transform]="
          'translateX(' +
          (this.selectedPiece == piece ? distanceX : 0) +
          'px) ' +
          'translateY(' +
          (this.selectedPiece == piece ? distanceY : 0) +
          'px)'
        "
      >
        <p
          [attr.role]="
            settings.isAccessibility && settings.os !== 2 ? 'button' : null
          "
          [attr.id]="'pos' + i"
          [attr.aria-labelledby]="settings.isAccessibility ? 'label' + i : null"
          [attr.tabindex]="settings.isAccessibility ? '0' : null"
          [ngClass]="{
            piece3: boardSize == 3,
            piece4: boardSize == 4,
            piece5: boardSize == 5
          }"
        >
          {{ piece.number }}
        </p>
      </div>
      }
      <!-- end of pieces div -->
    </div>
    <!-- end of board div -->
  </div>
  <!-- end of board sides div -->

  <!-- This div appears when abandon is clicked, to ask if sure, we do it as modal: -->
  @if(askIfAbandon) {
  <div
    class="askIfAbandon"
    role="dialog"
    aria-modal="true"
    cdkTrapFocus
    [cdkTrapFocusAutoCapture]="true"
  >
    <span role="alert">
      {{ settings.getString("MSG_ARE_SURE") }}
    </span>
    <button id="btnYes" (click)="abandonEffectively()" class="btn">
      {{ settings.getString("BT_YES") }}
    </button>
    <button id="btnNo" (click)="dontAbandon()" class="btn">
      {{ settings.getString("BT_NO") }}
    </button>
  </div>
  }

  <!-- The bottom buttons: -->
  @if(!gameStarted) {
  <button (click)="startGame()" class="btn" [disabled]="gameStarted">
    {{ settings.getString("BT_START") }}
  </button>
  } @if(!(!gameStarted || askIfAbandon)) {
  <button
    (click)="askForAbandon()"
    class="btn"
    [disabled]="!gameStarted || askIfAbandon"
  >
    {{ settings.getString("BT_ABANDON") }}
  </button>
  } @if(!(!gameStarted || askIfAbandon)) {
  <button
    (click)="saveCurrentGame()"
    class="btn"
    [disabled]="!gameStarted || askIfAbandon || initialNrMoves == nrMoves"
  >
    {{ settings.getString("BT_SAVE") }}
  </button>
  }

  <!-- This div appears when the game is saved, as a notification: -->
  @if(showMessageSavedGame) {
  <div class="savedMessageDiv">
    <span role="alert">
      {{ settings.getString("MSG_GAME_SAVED1") }}
      <br />
      {{ settings.getString("MSG_GAME_SAVED2") }}
    </span>
  </div>
  }

  <!-- Here a div for aria labels, only if is enabled in settings: -->
  @if(settings.isAccessibility) {
  <div style="display: none">
    @for(label of ariaLabels; track $index; let i = $index) {
    <p [attr.id]="'label' + i">
      {{ label }}
    </p>
    }
  </div>
  }
  <!-- end aria labels div. -->
</div>
}
<!-- end game zone, second page of the application. -->

<!-- The settings zone, fourth page of the application, currSection = 3: -->
@if(currSection == 3) {
<div class="container">
  <button
    (click)="goBackToMain()"
    class="back-btn"
    [attr.aria-label]="settings.getString('BT_BACK')"
  >
    <img src="../assets/arrow-left-solid.svg" alt="" />
  </button>
  <app-settings></app-settings>
</div>
}
<!-- end settings zone, fourth page of the application. -->

<!-- The about zone, fifth page of the application, currSection = 4: -->
@if(currSection == 4) {
<div class="container about-container">
  <button
    (click)="goBackToMain()"
    class="back-btn"
    [attr.aria-label]="settings.getString('BT_BACK')"
  >
    <img src="../assets/arrow-left-solid.svg" alt="" />
  </button>
  <app-about></app-about>
</div>
}
<!-- end about zone, fifth page of the application. -->

<!-- The statistics zone, sixth page of the application, currSection = 5: -->
@if(currSection == 5) {
<div class="container stats-container">
  <button
    (click)="goBackToMain()"
    class="back-btn"
    [attr.aria-label]="settings.getString('BT_BACK')"
  >
    <img src="../assets/arrow-left-solid.svg" alt="" />
  </button>
  <app-statistics></app-statistics>
</div>
}
<!-- end statistics zone, sixth page of the application. -->
